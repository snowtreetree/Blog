# 缓存

## 缓存类型
浏览器中的缓存分为两种情况，一种是需要发送HTTP请求，一种是不需要发送请求。

### 强缓存

不需要发送请求。对应字段Expires(HTTP/1.0)，Cache-Control(HTTP/1.1)。

#### Expires（过期时间）

返回的响应头中，内容是时间节点，告诉浏览器在xxx时间点之前的请求，可以直接从缓存里面获取。但是服务器和客户端的时间可能不一致。

#### Cache-Control（优先级高于Expires）

- max-age：过期时长，单位为秒
- no-cache： 跳过当前强缓存，进入协商缓存
- no-store： 不缓存
- s-maxage： 针对代理服务器的缓存时间

### 协商缓存

强制缓存失效后，服务器根据请求头中的Etag和Last-Modified，告诉客户端是否启动缓存。

#### Last-Modified(响应)/f-Modified-Since（请求）

最后修改时间。  

- 如果请求头的时间小于修改时间，返回新的资源
- 否则返回304，浏览器使用缓存

#### Etag（响应）/If-None-Match（请求）

文件唯一标识。

- 两者不一样，返回新的资源
- 否则采用缓存

## 缓存位置

- Service Worker(PWA实现机制)
- Memory Cache
    内存缓存。效率最快，但是存活时间较短，渲染进程结束后，内存缓存就不存在了。
- Disk Cache
    存储在磁盘中的缓存，比内存缓存慢，但是存储容量和时间较长
    - 较大文件的JS、CSS文件会放到磁盘，反之放到内存缓存
    - 内容使用率较高的时候，文件进到磁盘

- Push Cache
    - 推送缓存。应用较少，属于HTTP2相关的内容


