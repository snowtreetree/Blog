# HTTP2

::: tip
HTTP2采用二进制格式传输，解析更高效，HTTP1.x采用文本格式。  
基于Google的SPDY 协议，注重性能改善。  
HTTP3基于Google的QUIC（Quick UDP Internet Connection）协议，基于UDP [HTTP3](https://www.zhihu.com/question/302412059)。
:::

## HTTP2改进内容

提高了HTTP1.x的性能，在兼容1.x的基础上，进一步减少了网络延迟。

特点：`多路复用，二进制分帧，首部压缩（SPDY），服务器推送，强化安全`

### 多路复用

允许同时发起多重请求-响应  
多路复用代替了HTTP1.x的序列和阻塞机制。同域名下的请求都会通过同一个TCP连接并完成。在HTTP1.x中，并发请求会创建多个TCP连接，浏览器会控制在6-8个连接。  
多路复用消除了TCP连接带来的延时和内存消耗，请求之间也不会相互影响

### 二进制分帧

TCP慢启动， TCP 会随着时间进行自我调谐，起初会限制最大连接速度，后续数据传输成功，会随着时间推移提高传输速度。

另外之前传输信息都是通过明文传输，便于开发调试，但是机器解析起来，对于大小写、空白符、回车、换行等可能会有歧义。

使用二进制，可以严格规定字段大小、顺序、标志位等，避免歧义。

在应用层（HTTP2）和传输层（UDP或TCP）只不过之间增加一个二进制分帧层。  
二进制分帧层会将传输的信息分割为更小的消息和帧，并进行二进制编码。

### 首部压缩/头部压缩

减少数据传输。

报文头部的信息，常常都是一些重复或者众所周知的信息，传输的信息可能只占了很小的一部分，这些头部信息却是有几百上千字节。

并不是使用传统的压缩算法，而是专门开发了HPACK算法，在客户端和服务器两端，各自维护了一份索引表`字典`，用索引表示重复的字符串，还用哈夫曼编码压缩证书和字符串。

### 服务器推送

服务器还没有收到响应的请求，就把各种资源推送给浏览器。

### 强化安全

HTTP2必须要加密。
